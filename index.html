<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Viewer</title>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it-footnote/dist/markdown-it-footnote.min.js"></script>
</head>
<body>
    <h1>Markdown Files</h1>
    <ul id="file-list"></ul>
    <div id="content"></div>

    <script>
        const repoOwner = "exotriks";
        const repoName = "civisme";
        const branch = "master"; // Change to "main" if needed
        const folderPath = "books/md"; // Your Markdown folder
        const fileList = document.getElementById("file-list");
        const contentDiv = document.getElementById("content");

        // Initialize markdown-it with footnote support
        const md = window.markdownit({ html: true }).use(window.markdownitFootnote);

        async function fetchMarkdownFiles() {
            const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}`;
            const response = await fetch(apiUrl);
            const files = await response.json();
            
            files.forEach(file => {
                if (file.name.endsWith(".md")) {
                    const li = document.createElement("li");
                    const link = document.createElement("a");
                    link.href = "#";
                    link.textContent = file.name;
                    link.onclick = () => loadMarkdown(file.download_url);
                    li.appendChild(link);
                    fileList.appendChild(li);
                }
            });
        }

        async function loadMarkdown(url) {
            const response = await fetch(url);
            const markdown = await response.text();
            contentDiv.innerHTML = md.render(markdown);
        }

        fetchMarkdownFiles();
    </script>
</body>
</html>
